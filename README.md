# __FilmHub API__

FilmHub - это API для управления фильмами и актерами с авторизацией для пользователей и администраторов. Приложение разработано с использованием чистой архитектуры и настроено с помощью переменных окружения. Оно также покрыто тестами и упаковано в Docker для удобного развертывания и масштабирования.

* [Запуск приложения](#1-запуск-приложения)
    - [Установка зависимостей](#15-установка-зависимостей)
    - [Сборка Docker-образа](#16-сборка-docker-образа)
    - [Запуск приложения](#17-запуск-приложения)
    - [Тестирование приложения](#18-тестирование-приложения)
    - [Веб-интерфейс API](#20-веб-интерфейс-api)
    - [Очистка](#21-очистка)
* [Аутентификация](#3-аутентификация)
* [Регистрация](#4-регистрация)
* [Создание актера](#5-создание-актера)
* [Удаление актера](#6-удаление-актера)
* [Обновление информации об актере](#7-обновление-информации-об-актере)
* [Получение информации об актере](#8-получение-информации-об-актере)
* [Получение всех актеров](#9-получение-всех-актеров)
* [Создание фильма](#10-создание-фильма)
* [Удаление фильма](#11-удаление-фильма)
* [Обновление информации о фильме](#12-обновление-информации-о-фильме)
* [Получение всех фильмов](#13-получение-всех-фильмов)
* [Поиск фильмов](#14-поиск-фильмов)

<a id="1-запуск-приложения"></a>

## Запуск приложения

Для запуска приложения FilmHub вам потребуется выполнить несколько простых шагов.

<a id="15-установка-зависимостей"></a>

### Установка зависимостей

Перед запуском приложения убедитесь, что у вас установлен Docker и Docker Compose.

<a id="16-сборка-docker-образа"></a>

### Сборка Docker-образа

Для сборки Docker-образа приложения выполните команду: 
<code style="background-color: lightgrey;">make build</code> 
Это создаст Docker-образ приложения, готовый к запуску.

<a id="17-запуск-приложения"></a>

### Запуск приложения

После сборки Docker-образа выполните команду:
<code style="background-color: lightgrey;">make run</code>
Это запустит приложение FilmHub в контейнере Docker. При первом запуске происходит инициализация базы данных, потребуется несколько секунд времени.

<a id="18-тестирование-приложения"></a>

### Тестирование приложения

Для запуска автоматических тестов выполните команду:
<code style="background-color: lightgrey;">make test</code>
Это запустит набор автоматических тестов для проверки функциональности API.

<a id="20-веб-интерфейс-api"></a>

### Веб-интерфейс API

После успешного запуска приложения вы можете получить доступ к веб-интерфейсу API по адресу:
http://127.0.0.1:8000/swagger/
Здесь вы найдете документацию и возможность протестировать API прямо в браузере.

<a id="21-очистка"></a>

### Очистка

После завершения работы с приложением вы можете остановить и удалить все контейнеры Docker, связанные с проектом, выполнив команду:
<code style="background-color: lightgrey;">make clean</code>

<a id="3-аутентификация"></a>

## Аутентификация

Для доступа к API требуется прохождение процесса аутентификации с использованием токена доступа. Для получения этого токена можно воспользоваться эндпоинтом /auth/sign-in. Для тестирования доступа в роли администратора используйте логин и пароль: __admin__ и __kek__ соответственно. После успешной аутентификации и получения токена пользователь будет авторизован для выполнения запросов к API.

<a id="4-регистрация"></a>

## Регистрация

Для регистрации нового пользователя можно использовать эндпоинт /auth/sign-up. 

<a id="5-создание-актера"></a>

## Создание актера
 
Чтобы создать нового актера, отправьте POST-запрос на эндпоинт /api/actor. Для этого в теле запроса укажите следующие поля:

* name: Имя актера
* gender: Пол актера (допустимые значения: "male", "female", "other")
* birth_date: Дата рождения актера в формате "YYYY-MM-DD"
* movies (необязательно): Список фильмов, в которых участвует актер

Для выполнения операции необходимы права администратора.

<a id="6-удаление-актера"></a>

## Удаление актера

Для удаления актера отправьте DELETE-запрос на эндпоинт /api/actor/{id}, где {id} - идентификатор удаляемого актера. При этом необходимо иметь права администратора. 

<a id="7-обновление-информации-об-актере"></a>

## Обновление информации об актере

Чтобы обновить информацию об актере, отправьте PUT-запрос на эндпоинт /api/actor/{id}, где {id} - идентификатор актера, информацию о котором необходимо обновить. Здесь вы можете добавить список фильмов для актера. Если какое-то поле не надо обновлять, удалите его из запроса. Для выполнения операции необходимы права администратора.

<a id="8-получение-информации-об-актере"></a>

## Получение информации об актере

Для получения информации об актере отправьте GET-запрос на эндпоинт /api/actor/{id}, где {id} - идентификатор интересующего вас актера.

<a id="9-получение-всех-актеров"></a>

## Получение всех актеров

Для получения списка всех актеров отправьте GET-запрос на эндпоинт /api/actors.

<a id="10-создание-фильма"></a>

## Создание фильма

Чтобы создать новый фильм, отправьте POST-запрос на эндпоинт /api/movie. В теле запроса укажите следующие поля:

* title: Название фильма
* description: Описание фильма
* release_date: Дата выхода фильма в формате "YYYY-M-D"
* rating: Рейтинг фильма
* actors (необязательно): Список актеров, участвующих в фильме

Для выполнения операции необходимы права администратора.

<a id="11-удаление-фильма"></a>

## Удаление фильма

Чтобы удалить фильм, отправьте DELETE-запрос на эндпоинт /api/movie/{id}, где {id} - идентификатор удаляемого фильма. Для выполнения операции необходимы права администратора.

<a id="12-обновление-информации-о-фильме"></a>

## Обновление информации о фильме

Для обновления информации о фильме отправьте PUT-запрос на эндпоинт /api/movie/{id}, где {id} - идентификатор обновляемого фильма. Здесь также вы можете добавить список актеров. Если какое-то поле не надо обновлять, удалите его из запроса. Для выполнения операции необходимы права администратора.

<a id="13-получение-всех-фильмов"></a>

## Получение всех фильмов

Чтобы получить список всех фильмов, отправьте GET-запрос на эндпоинт /api/movies. Вы также можете указать критерии сортировки, добавив параметры sort_by (по какому полю сортировать - release_date, title, rating) и sort_order (порядок сортировки - asc, desc) к запросу. Если параметры сортировки не указаны, будет использованы значения по умолчанию: сортировка по рейтингу в порядке убывания.

<a id="14-поиск-фильмов"></a>

## Поиск фильмов

Вы можете выполнить поиск фильмов по названию или имени актера. Для этого отправьте GET-запрос на эндпоинт /api/movie/search, предоставив параметр title для поиска по названию фильма или actor для поиска по имени актера. 
